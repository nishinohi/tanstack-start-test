---
description: "これまでの作業内容を確認し適切な粒度でコミットする"
allowed-tools:
  - Bash(git add:*)
  - Bash(git commit:*)
  - Bash(git status:*)
  - Bash(git diff:*)
  - Bash(git log:*)
---

## 言語

- 日本語でコミットメッセージを記述する

## 適切なコミット粒度

### 原則

- 1 つのコミットには 1 つの論理的な変更のみを含める

### 良いコミットの例

- 単一機能の追加
  - `feat: メニュー取得APIを実装`
- 単一バグの修正
  - `fix: ログイン時のセッションエラーを修正`
- 関連するリファクタリング：
  - `refactor: 認証ロジックを共通化`

### 避けるべきコミットの例

- 無関係な変更の混在
  - `feat: ログイン機能追加、メニュー表示修正、READMEリファクタリング`
- 大きすぎる変更
  - `feat: 連携機能全体を実装`

### コミット分割の判断基準

- 機能的な独立性
  - 他の変更なしに動作するか
- レビューの容易さ
  - 差分が理解しやすいサイズか
- 履歴の追跡性
  - 後から特定の変更を見つけやすいか

## ワークフロー

### 差分を分析

```bash
git status -s
# 新規ファイルがある場合
git add . -N
git diff
```

大きな差分（500 行超）の場合はまず `--stat` を確認し主要なファイルを選択的に確認。

### コミットを生成・実行

以下のフォーマットでコミットを作成。

```txt
<type>[(<scope>)]: <subject>

<body>
```

- type
  - feat, fix, docs, style, refactor, perf, test, agent
  - agent は claude code などの設定更新で使用
- scope
  - 任意
- subject
  - 命令形、小文字、句点なし、50 文字以内
- body
  - 内容は how（どうやって）ではなく what/why（何を/なぜ）を重視する
  - 72 文字で折り返し
  - 差分が少なく subject で差分の内容を十分伝えられる場合は省略可
